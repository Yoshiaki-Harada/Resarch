# クラウドソースドマニュファクチャリングに対するオークションの適用

本章ではオークションを適用したクラウドソースドマニュファクチャリングモデルについて説明を行う．その後オークションについて説明し，本研究でリソース配分のために使用する組合せダブルオークションについて詳細な説明を行う．

## 対象モデル

本研究の対象であるクラウドソースドマニュファクチャリングにオークションを適用したモデル図を[@fig:csmfg]に示す．

![Crowdsourced Manufacturing model](/Users/haradayoshiaki/Resarch/Paper/master-thesis/src/img/crowdsourced-manufacturing.png){#fig:csmfg width=90%}

リソースの提供側とリソースの要求側，そしてオークション主催者が存在する．それぞれの主体について説明する．

+ リソース要求企業: 要求するリソースの時間，予算を入札する．
  + 処理不可能な場合に必要リソースを要求する企業をリソース要求企業と呼ぶ．
+ リソース提供企業: 提供するリソースの時間，コストを入札する．
  + リソースの遊休時間にそのリソースを他企業に提供する企業をリソース提供企業と呼ぶ．
+ オークション主催者: リソース提供・要求企業の入札を元にリソースの配分と，取引価格を決定する．
  + 本研究においてはオークション主催者の利益は考慮しないものとする．

クラウドソースドマニュファクチャリングにおいては製造工程間で輸送が発生するため，対象とする製品の処理要求は，工程毎に分割可能とする．

## オークション

本節ではオークションに関する一般的な説明を行った上で，本研究で行う組合せダブルオークションについて説明する．

### オークションとは

オークションは，分散化された意思決定下において財の配分と取引価格を決めるルールのことを指す\cite{market}．近年周波数帯オークション，ネット広告オークションでの成功から更に注目が集まっている\cite{yokoo}．

オークションの説明に使用される用語を以下に示す\cite{market}．

+ 財: オークションにおいて取引される資源のこと
+ 入札: 財に対する評価値を表明すること
  + この値を入札値と呼ぶ．
+ 準線形環境: 金銭と効用(利益)が交換可能な環境のこと
  + オークションでは理論解析を簡単にするためほどんどの場合で準線形環境を仮定する．
+ 買い手: 金銭を払って財を入手することで利益を得たい主体のこと
  + 買い手の利益は財を入手するのに必要だった価格と評価値の差である．
    + 例．評価値1000円の財を500円で買った買い手の利益は500円となる．
+ 売り手: 財を売って金銭を得ることで利益を得たい主体のこと
  + 売り手の利益は実際に受け取った報酬と評価値の差である．
    + 例．評価値500円の財を1000円で売った売り手の利益は500円となる．
+ 真の評価値: その値で財の取引を行うと，利益が0となる値のこと
+ オークション主催者: ある目的を達成するために入札を元に財の配分と価格を決める主体のこと
  + オークションの目的は参加者の効用の合計(社会的余剰)の最大化，つまり総利益の最大化である．

### オークションの財に関する分類

オークションに掛けられる財の種類による分類を以下で説明する．

#### 単一財オークション

オークションにかけられる財が1つであるオークションのことを指す．

#### 複数財オークション

オークションにかけられる財が複数財であるオークションのことを指す．その中でもさらに複数ユニットオークションと組合せオークションの2つに分類される．

##### 複数ユニットオークション

同じ種類の財が複数単位かけられるオークションを複数ユニットオークションと言う．

##### 組合せオークション

複数種類の財が複数単位オークションにかけられ，入手できる組合せによって財の価値が変わるオークションのことを指す．組合せオークションでは財の組合せに対して入札が可能である．組合せオークションでは財同士の価値の間に依存関係がある場合が存在する．例えばメモリとパソコンのように，メモリだけでは無価値でまたメモリが少ないPCが使い勝手が悪いと言うように同時に所有できると価値が高まるなどの関係である．このように相互に補完して効用を得る財の関係のことを補完性と呼ぶ．またメモリでも，A社のメモリともB社のメモリが存在するが1つしか必要ない場合のような片方が片方の代わりになる財の関係を代替性と呼ぶ．

### オークションの入札に関する分類

次にオークションの入札を誰が行うかに着目した分類について説明する\cite{yokoo}．

#### シングルオークション(シングルサイドオークション)

入札を行う主体が買い手または売り手の片方である場合をシングルサイドオークションと言う．シングルサイドオークションの場合，入札者がオークション主催者の役割を担うことが多い．また売り手のみが入札を行うオークションを特にリバースオークションと呼ぶ場合もある．

#### ダブルオークション(ダブルサイドオークション)

入札を行う主体が買い手，売り手の双方である場合をダブルサイドオークションと言う．

### オークションの評価指標

本項ではオークションが満たすべき性質について説明する．

#### 個人合理性

オークションに参加することで損をする者がいない性質のことを指す．個人合理性を満たさないオークションはオークションに参加することで損をしてしまう可能性があるので，参加者を集めることが極めて困難になる．

#### パレート効率性

誰かの効用を下げない限り他の誰かの効用を高めることができない状態のことを指す．またこのようなß状態を導くオークションのことをパレート効率性を満たすオークションと言う．例えば，総利益が最大化されている状態はパレート効率な状態であり，ある誰かの利益を下げない限り他の誰かの利益を上げることはできない．

#### 耐戦略性

正直に真の評価値を入札値として申告することが支配戦略であるオークションのことを指す．耐戦略性を満たすオークションでは．財に対する真の評価値をそのまま申告することが自分の利益を最大化する為の支配戦略となる．この性質を満たさないオークションは以下2点の欠点がある．

+ オークション主催者が目指したい結果を正しく導くことができない．
  + オークション主催者は入札者の入札値を元に財の配分を決める．しかし耐戦略性を満たさないオークションはその入札値が真の評価値とは限らず，導いた結果が本来の目的を達成できているかが分からない．
+ 入札者が入札戦略を考える必要がある．
  + 耐戦略性を満たさないオークションの場合正直な評価値の申告が支配戦略でないので，どのような入札値で入札するべきかを考える必要がある．

### 代表的なオークションの例

本項では代表的なオークションについて説明する．

#### ファーストプライスオークション

ファーストプライスオークションは，勝者となった入札者の入札値で取引を行うオークションである．オークション主催者に対して利益を考慮した値を入札値として提出する．ファーストプライスオークションを以下に示す．

+ ルール
  + 財に対する入札を一度だけ行う．
    + 入札値はオークション主催者にしか公開されない
  + 一番入札値が高い入札者がその入札値でその財を得ることができる(リバースオークションの場合は一番低い入札値の入札者が売ることができる)
+ 分類
  + 単一財オークション
  + シングルサイドオークション
+ 性質
  + 個人合理性を満たす
  + パレート効率性を満たさない
  + 耐戦略性を満たさない

ファーストプライスオークションはオークションはルールがシンプルであり，また自分の入札値で取引が行われることから透明性が求められるネット広告オークションなどに使用される\cite{google}．しかし耐戦略性を満たせず支配戦略が存在しないので，入札戦略が複雑になるなどのデメリットが存在する．

#### セカンドプライスオークション

セカンドプライスオークションは単一財オークションであり，耐戦略性を満たすオークションである．勝者の取引価格はこのオークションで勝者として留まれる最小(最大)の価格となっている．この価格をcritical priceと呼ぶ．セカンドプライスオークションは以下の特徴を持つ．

+ ルール
  + 財に対する入札を一度だけ行う
    + 入札値はオークション主催者にしか公開されない
  + 一番入札値が高い入札者が勝者となりその次に高い入札者の入札値(二位の価格)でその財を得ることができる(リバースオークションの場合は一番低い入札値の入札者が，その次に低い入札値で売ることができる)
+ 分類
  + 単一財オークション
  + シングルサイドオークション
+ 性質
  + 個人合理性を満たす，
  + パレート効率性を満たす．
  + 耐戦略性を満たす．

セカンドプライスオークションは，二位の価格と財に対する真の評価値との差がオークションの勝者となった入札者の利益となる．このオークションは個人合理性・パレート効率性・耐戦略性を満たすことができ，真の評価値で入札することが支配戦略となる．現実の適用例としては，Yahooオークションなどが挙げられる\cite{yahoo}．

#### VCGオークション(Vickrey–Clarke–Groves Auction) \label{VCG}

シングルサイド組合せオークションの代表的なオークションであるVCG(Vickrey–Clarke–Groves Auction)オークション\cite{vickrey}はセカンドプライスオークションを一般化し，財の組合せに対する入札に対応したものである．理論的に優れた性質(個人合理性・パレート効率性・耐戦略性)を持つことからKing of Mechanismsとも呼ばれる．VCGオークションは以下の特徴を持つ．

+ ルール
  + 財に対する入札を一度だけ行う．
    + 入札値はオークション主催者にのみ公開される．
  + 財の配分(オークションの勝者)は目的が総利益最大である組合せ最適化問題を解くことで決定される．
    + この問題を勝者決定問題と呼ぶ．
  + オークションの勝者は勝者として留まれる最小の価格を支払う．
    + 価格を決める式は後述する．
+ 分類
  + 組合せオークション
  + シングルサイドオークション
+ 性質
  + 個人合理性を満たす．
  + パレート効率性を満たす．
  + 耐戦略性を満たす．

以下VCGオークションにおける勝者決定問題，価格の決定方法にいついて詳しく説明し，その後で性質について詳しく説明する．ただし買い手が入札する場合について説明する．

##### 勝者決定問題の定式化

VCGオークションの勝者を決める勝者決定問題は，組合せ最適化問題として定式化される．

定式化に用いる記号の定義は以下の通りである．

+ $j$: 買い手$j\in \boldsymbol{J}$
+ $n$: 買い手$j$の入札$n \in \boldsymbol{N}$
+ $f_{j,n}$: 買い手$j$の$n$番目の入札の評価値
+ $a_{j,n,r}$: 買い手$j$の入札$n$に財$r$が含まれるとき1，含まれないとき0となる定数
+ $r$: オークションにかけられる財$r \in \boldsymbol{R}$
+ $V(\boldsymbol{J})$: 提供企業の集合が$\boldsymbol{J}$であるときの勝者決定問題の目的関数値

上記の記号を用いて勝者決定問題を定式化する．
$$
\begin{align}
	{\rm max}\quad &V(\boldsymbol{J})=\sum_{j\in\boldsymbol{J}}\sum_{n \in \boldsymbol{N}}f_{j,n} \times x_{j,n}  \label{eq:vcg-obj}\\  
  {\rm s.t.} \quad &\sum_{j\in\boldsymbol{J}}\sum_{n\in\boldsymbol{N}} a_{j,n,r}\times x_{j,n}\leq 1 &(\forall r)　\label{eq:vcg-cap-sub}\\
                  &\sum_{n \in \boldsymbol{N}} x_{j,n}\leq 1  			&(\forall j)\\
                  &x_{j,n} \in \{0,1\}			&(\forall j,\forall n) 
\end{align}
$$

決定変数は$x_{j,n}$であり，この値が1のとき入札者$j$の入札$n$が勝者となり入札に含れる財が落札され，この値が0のときに入札者$j$の入札$n$のは敗者となる．$\eqref{eq:vcg-obj}$は目的関数であり，入札値の合計の最大化を表す．$\eqref{eq:vcg-cap-sub}$は財を落札できるのは高々1入札者であることを表す制約である．これは財の容量制約を表す．この最大化問題を解くことで，評価値が最大化される割当が実現し総利益が最大化され，パレート効率性が満たされる．

##### 価格の式

VCGオークションにおいて勝者となった$j$の入札$n$の支払い$pay_{j}$は以下のように定まる．
$$
\begin{align}
pay_{j} = -\{-f_{j,n}+V(\boldsymbol{J})\}+V(\boldsymbol{J}\backslash j) \label{eq:vcg-pay}
\end{align}
$$
$V(\boldsymbol{J}\backslash  j)$は$j$を除いたオークションの勝者決定問題の目的関数値を表す．また，$\{-f_{j,n}+V(\boldsymbol{J})\}$は目的関数値から支払いを決めようとする入札の入札値を除いた値である．よって$pay_{j}$は$j$の入札値に関わらず決定されている．$\eqref{eq:vcg-pay}$で決定される支払いが耐戦略性，個人合理性を示すことを[@fig:vcg-under-1]〜[@fig:vcg-excessively-2]を用いて説明する．ただしそれぞれの横軸は金額を表す．また買い手$j$の入札$n$の真の評価値を$t_{j,n}$とする．

過少申告を行う場合において，虚偽申告により$f_{j,n}$($pay_j<f_{j,n}<t_{j,n}$)と申告した場合を考える．[@fig:vcg-under-1]より過少申告により$pay_j$は変わらない．よって利益$t_{j,n}-pay_j$は変わらないことがわかる．

![VCG payment:bid too little](/Users/haradayoshiaki/Resarch/Paper/master-thesis/src/img/chapter-2/vcg-under.png){#fig:vcg-under-1 width=70%}

次に虚偽申告を行い$f_{j,n}(f_{j,n}<pay_j<t_{j,n})$と申告した場合を考える．[@fig:vcg-under-2]より$f_{j,n}$が小さくなると$V(\boldsymbol{J}\backslash{\{j\}})>V(\boldsymbol{J})$となり$P(\boldsymbol{J}\backslash{\{j\}})$の割当が$P(\boldsymbol{J})$で選ばれるようになる．従って買い手$j$は勝者となることができなくなってしまい，利益を得られなくなってしまう．

![VCG payment:bid too little and lose the auction](/Users/haradayoshiaki/Resarch/Paper/master-thesis/src/img/chapter-2/vcg-underreporting-2.png){#fig:vcg-under-2 width=70%}

次に買い手$j$が勝者となれる場合に，過大申告を行い評価値を$f_{j,n}(f_{j,n}>t_{j,n})$とする場合を考える．虚偽申告を行ったとしても[@fig:vcg-excessively-1]より$pay_j$は変わらず利益$t_{j,n}-pay_j$は変わらないことがわかる．

![VCG payment:bid excessively](/Users/haradayoshiaki/Resarch/Paper/master-thesis/src/img/chapter-2/vcg-excessively-1.png){#fig:vcg-excessively-1 width=70%}

次に買い手$j$が真の評価値を入札すると勝者となれないが，虚偽申告を行いある入札を$f_{j,n}>t_{j,n}$とすることで勝者となれた場合を考える．そのときの勝者決定問題の目的関数値を$V'(\boldsymbol{J})$とする．その様子を[@fig:vcg-excessively-2]に示す．また$V'(\boldsymbol{J}\backslash{\{j\}})$は買い手$j$が虚偽申告を行わない場合の目的関数値$V(J)$に一致する．このときの$pay_j$はどの$j$の入札の真の評価値$t_{j,n} (\forall \boldsymbol{N})$よりも高いので，利益が$t_{j,n}-pay_j<0$となり損をする結果となる．もし$pay_j<t_{j,n}$より評価値が高い入札の評価値があれば$P(\boldsymbol{J})$において勝者となれていたはずである．

![VCG payment:bid excessively if bid truthful and lose the auction](/Users/haradayoshiaki/Resarch/Paper/master-thesis/src/img/chapter-2/vcg-excessively-2.png){#fig:vcg-excessively-2 width=70%}



以上により正直に評価値を申告するときが一番利益が高くなり，耐戦略性を満たす．また$pay_j$は買い手$j$がオークションの勝者となれる最小の価格となっている．耐戦略性を満たすオークションは自身がオークションの勝者に留まれる最小の価格(critical  price)を支払うことになる．そして虚偽の申告をしない限り利益が負になることがないので個人合理性も満たすことができる．

#### ザラ場方式

ザラ場方式は証券取引などに用いられるダブル(サイド)オークションの1つである．5秒ごとに付け合せが行われる板寄せ方式も存在するが，スピード．効率，透明性ではザラバ方式が上回り，世界の主要な株式市場で用いられている\cite{zaraba}．

+ ルール
  + 買い手，売り手がそれぞれ見ることができる場に販売希望価格と購入希望価格を入札する．
    + 売り手はすでに場に出ている販売希望価格以上の価格しか入札できない
    + 買い手はすでに場に出ている購入希望価格以上の価格しか入札できない
  + 販売希望価格と購入希望価格が一致する瞬間に取引が成立する．
  + 定められた時間まで連続的に取引が行われる．
+ 分類
  + 複数ユニットオークション
  + ダブル(サイド)オークション
+ 性質
  + 個人合理性を満たす．
  + パレート効率性を満たす．(実験的に示されている\cite{cliff})
  + 耐戦略性を満たさない．

## 本研究における組合せダブルオークション\label{double-auction}

従来の製造業における組合せオークションを応用した研究では，シングルサイドオークションが多く扱われてきた\cite{suginouchi}．しかし本研究のクラウドソースドマニュファクチャリングにおいては．リソース提供企業・リソース要求企業の双方の意思を反映させるために，ダブルオークションを適用する．そうすることで提供企業と要求企業の総利益が最大化される配分を求めることを可能とした．本研究で行う組合せダブルオークションは以下の特徴を持つ．

+ 入札者
  + リソース提供側(買い手)
    + 複数ユニットオークション: リソース複数単位(複数時間)提供することが可能である．
  + リソース要求側(売り手)
    + 組合せオークション: 全てのリソースが揃わないと製品を作るが出来ず利益を得ることが出来ないからである．
+ オークション主催者
  + 提供企業，要求企業の入札をもとに総利益の最大化するリソース配分を求める．

ダブルオークション環境下において，オークション主催者を含めた個人合理性，パレート効率性，耐戦略性の全てを満たすオークションは存在しないことが示されている\cite{Ohseto2000}．そこで本研究では個人合理性を満たした上で，パレート効率性を満たす手法Iと，耐戦略性を満たす手法IIの提案を行う．次項では手法I，手法IIの共通部分について説明する．

### 共通の流れ

提案するリソース配分手法は，大きく分けて入札作成部分と，オークション主催者のリソース配分と取引価格決定部分の2つからなる．

1. 入札作成
   + リソース提供企業はオークション主催者に入札を行う．
     + 提供するリソース$r \in \boldsymbol{R}$のコスト$c_{i,r}$と提供時間からなる入札を$|\boldsymbol{R}|$個作成する．
   + リソース提供企業はオークション主催者に入札を行う．
     + 予算$v_{j,n}$と要求するリソース$r \in \boldsymbol{R}$の要求時間$TR_{j,n,r}$からなる入札$n$を$N$個提示する．
     + 勝者となる入札は1つとする．
     + 必要なリソースの組合せに対してリソースの入札を作成する．
2. オークション主催者はリソースの配分と，取引価格の決定する．

2については手法I，手法IIで異なるので次章以降で説明する.ここでは両手法で共通な1.入札作成について説明する．

### 入札作成\label{make-bid}

作成された入札の例を[@fig:example-bid]に示す．

![Example of bids](/Users/haradayoshiaki/Resarch/Paper/master-thesis/src/img/chapter-2/bid.png){#fig:example-bid width=90%}

提供企業$1$はリソース1をコスト0.1[円]で150[Ts]提供し，リソース2をコスト0.2円で100[Ts]提供していることを表す．同様に，提供企業$2$はリソース2をコスト0.5[円]で200[Ts]提供する．要求企業$1$は入札$1$において予算150円で，リソース$2$とリソースを50[Ts]要求している．同様に要求企業$2$は入札$1$において予算200で，リソース1を100[Ts]，リソース2を50[Ts]要求する入札を作成している．

第3章，4章においてはそれぞれの手法について，オークションの観点からパレート効率性，耐戦略性，クラウドソースドマニュファクチャリングの観点から総利益，提供企業利益，要求企業利益を中心に特性評価を行う．

