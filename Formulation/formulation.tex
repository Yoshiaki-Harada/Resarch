\documentclass[uplatex]{ujarticle}
\usepackage{amsmath}
\usepackage[deluxe]{otf}
\usepackage[sourcehan]{pxchfon}
\usepackage{nccmath}
\usepackage{bm}
\begin{document}
利益最大化目的関数

\begin{flalign*}
  % 目的関数
  {\rm max} \quad &\sum_{j=1}^{J}\sum_{n=1}^{N}v_{j}\times y_{j,n} \\
  &-\sum_{i=1}^{I}\sum_{r=1}^{R}\sum_{j=1}^{J}\sum_{n=1}^{N}c_{i,r}\times TR_{i,n,r}\times x_{i,r,j,n} \\ 
  % 提供側の容量制約
  {\rm s.t.} \quad &\sum_{j=1}^{J}\sum_{n=1}^{N}TR_{j,n,r}  \times x_{i,r,j,n}
  \leq TP_{i,r} \quad (\forall i, \forall r)  \\ 
  &\begin{cases}
    x_{i,r,j,n} = 0  &({\rm if} \ y_{j,n}=0) \\
    \sum_{i=1}^{I}\sum_{n=1}^{N} TR_{j,n,r} \times x_{i,r,j,n} \\ \quad \quad = TR_{j,n,r}
     &({\rm if} \ y_{j,n}=1) 
  \end{cases} \\
  % 要求企業jの入札nのリソースrを提供するのは高々1企業とする制約
  &\sum_{i=1}^{I}x_{i,r,j,n} \leq 1  \quad (\forall r, \forall j , \forall n) \\ 
  % 要求企業jの入札のうち勝者となる入札は高々１つとする制約
  &\sum_{n=1}^{N}x_{i,r,j,n} \leq 1 \quad (\forall i, \forall r, \forall j) \\ 
  % 要求企業jの入札のうち勝者となる入札は高々１つとする制約
  &\sum_{n=1}^{N}y_{j,n}  \leq 1 \quad (\forall j) \\
  % 要求企業jの予算制約
  &\sum_{i=1}^{I}\sum_{n=1}^{N}\sum_{r=1}^{R}PAY_{i,r,j,n} \leq v_{j,n} \quad (\forall j, \forall n) \\
  % 決定変数
  &x_{i,r,j,n},y_{j,n} \in {0,1} 
\end{flalign*}

コスト最小化
\begin{flalign*}
  % 目的関数
  {\rm min} \quad &\sum_{j=1}^{J} \alpha (1 - \sum_{n=1}^{N}y_{j,n}) + \sum_{i=1}^{I}\sum_{r=1}^{R}\sum_{j=1}^{J}\sum_{n=1}^{N}c_{i,r}\times TR_{j,n,r}\times x_{i,r,j,n} \\ 
  % 提供側の容量制約
  {\rm s.t.} \quad &\sum_{j=1}^{J}\sum_{n=1}^{N}TR_{j,n,r}  \times x_{i,r,j,n} \leq TP_{i,r} \quad (\forall i, \forall r) \\
  &\begin{cases}
    x_{i,r,j,n} = 0 \quad &({\rm if} \ y_{j,n}=0) \\
    \sum_{i=1}^{I}\sum_{n=1}^{N} TR_{j,n,r} \times x_{i,r,j,n} = TR_{j,n,r}
    \quad  &({\rm if} \ y_{j,n}=1) 
  \end{cases}
  \\
  % 要求企業jの入札nのリソースrを提供するのは高々1企業とする制約
  &\sum_{i=1}^{I}x_{i,r,j,n} \leq 1  \quad (\forall r, \forall j , \forall n) \\ 
  % 要求企業jの入札のうち勝者となる入札は高々１つとする制約
  &\sum_{n=1}^{N}x_{i,r,j,n} \leq 1 \quad (\forall i, \forall r, \forall j) \\ 
  % 要求企業jの入札のうち勝者となる入札は高々１つとする制約
  &\sum_{n=1}^{N}y_{j,n}  \leq 1 \quad (\forall j) \\
  % 要求企業jの予算制約
  &\sum_{i=1}^{I}\sum_{n=1}^{N}\sum_{r=1}^{R}PAY_{i,r,j,n} \leq v_{j,n} \quad (\forall j, \forall n) 
  % 決定変数
  &x_{i,r,j,n},y_{j,n} \in {0,1}
\end{flalign*}
提供単価最小化
\begin{flalign*}
  % 目的関数
  {\rm min} \quad &\sum_{j=1}^{J} \alpha (1 - \sum_{n=1}^{N}y_{j,n}) + \sum_{i=1}^{I}\sum_{r=1}^{R}\sum_{j=1}^{J}\sum_{n=1}^{N}p_{i,r}\times TR_{j,n,r}\times x_{i,r,j,n} \\ 
  % 提供側の容量制約
  {\rm s.t.} \quad &\sum_{j=1}^{J}\sum_{n=1}^{N}TR_{j,n,r}  \times x_{i,r,j,n} \leq TP_{i,r} \quad (\forall i, \forall r) \\
  &\begin{cases}
    x_{i,r,j,n} = 0 \quad &({\rm if} \ y_{j,n}=0) \\
    \sum_{i=1}^{I}\sum_{n=1}^{N} TR_{j,n,r} \times x_{i,r,j,n} = TR_{j,n,r}
    \quad  &({\rm if} \ y_{j,n}=1) 
  \end{cases}
  \\
  % 要求企業jの入札nのリソースrを提供するのは高々1企業とする制約
  &\sum_{i=1}^{I}x_{i,r,j,n} \leq 1  \quad (\forall r, \forall j , \forall n) \\ 
  % 要求企業jの入札のうち勝者となる入札は高々１つとする制約
  &\sum_{n=1}^{N}x_{i,r,j,n} \leq 1 \quad (\forall i, \forall r, \forall j) \\ 
  % 要求企業jの入札のうち勝者となる入札は高々１つとする制約
  &\sum_{n=1}^{N}y_{j,n}  \leq 1 \quad (\forall j) \\
  % 要求企業jの予算制約
  &\sum_{i=1}^{I}\sum_{n=1}^{N}\sum_{r=1}^{R}PAY_{i,r,j,n} \leq v_{j,n} \quad (\forall j, \forall n) 
  % 決定変数
  &x_{i,r,j,n},y_{j,n} \in {0,1}
\end{flalign*}

変数の説明 \\
\begin{align*}
  PAY_{i,r,j,n}: &\textgt{企業$i$と企業$j$が入札$n$において} \\
               &\textgt{リソース$r$を取引する価格} \\
  x_{i,r,j,n}:   &\textgt{企業$i$と企業$j$が入札$n$において} \\
               &\textgt{リソース$r$を取引するとき1，} \\
               &\textgt{しないとき0となる決定変数} \\
  y_{j,n}:       &\textgt{企業$j$の入札$n$が選ばれるとき1，} \\
               &\textgt{選ばれないとき0となる決定変数}
\end{align*}
提供企業1
\begin{align*}
 [(c_{1,1}, TP_{1,1},TP_{1,2}),(c_{1,2}, TP_{1,1},TP_{1,2}) \cdots] 
\end{align*}
\begin{align*}
 =[(0.1, 125, 0),(0.2,0,100) \cdots] 
\end{align*}
提供企業2
\begin{align*}
 [(c_{1,1}, TP_{1,1},TP_{1,2}),(c_{2,2}, TP_{1,1},TP_{2,2}) \cdots] 
\end{align*}
\begin{align*}
=[(0, 0, 0),(0.5,0,200) \cdots] 
\end{align*}
要求企業1
\begin{align*}
 [(v_{1,1},TR_{1,1,1},TR_{1,1,2}) \cdots] 
\end{align*}
\begin{align*}
 =[(150,150,0) \cdots] 
\end{align*}
要求企業2
\begin{align*}
 [(v_{2,1},TR_{2,1,1},TR_{2,1,2}) \cdots] 
\end{align*}
\begin{align*}
 =[(200,100,50) \cdots] 
\end{align*}
取引価格 
\begin{align*}
  PAY_{i,r,j,n} = \frac{c_{i,r} + v_{i,j} \times (\frac{TR_{j,n,r}}{sumTR_{j,n}})}{2} \times TR_{j,n,r} 
\end{align*}
\begin{align*}
 sumTR_{j,n} = \sum_{r=1}^{R}TR_{j,n,r} 
\end{align*}

\begin{align*}
  PAY_{i,r,j,n} = p_{i,r} \times TR_{j,n,r} 
\end{align*}
定式化
\begin{flalign*}
  % 目的関数
  {\rm max} \quad &\sum_{j\in \bm{J}}\sum_{n\in\bm{N_{j}}}v_{j} \times y_{j,n} - \sum_{i\in\bm{I}}\sum_{r\in\bm{R}}\sum_{j\in\bm{J}}\sum_{n\in\bm{N_{j}}}c_{i,r} \times x_{i,r,j,n} \\ 
  % 提供側の容量制約
  {\rm s.t.} \quad &\sum_{j\in \bm{J}}\sum_{n\in\bm{N_{j}}}x_{i,r,j,n} \leq TP_{i,r} \quad (\forall i, \forall r) \\
  &\begin{cases}
    x_{i,r,j,n} = 0 \quad &({\rm if} \ y_{j,n}=0) \\
    \sum_{j \in \bm{J}}\sum_{n \in \bm{N_{j}}} x_{i,r,j,n} = TR_{j,n,r}
    \quad  &({\rm if} \ y_{j,n}=1) 
  \end{cases}
  \\
  % 要求企業jの入札のうち勝者となる入札は高々１つとする制約
  &\sum_{n \in \bm{N_{j}}}y_{j,n}  \leq 1 \quad (\forall j) \\
  &x_{i,r,j,n}\in {0,1} \\
  &y_{j,n} \in \bm{Z}
\end{flalign*}

\begin{flalign*}
  % 目的関数
  {\rm max} \quad &V(\bm{I},\bm{J} ,\bm{Q})=\sum_{j\in \bm{J}}\sum_{n\in\bm{N_{j}}}v_{j} \times y_{j,n} - \sum_{i\in\bm{I}}\sum_{r\in\bm{R}}\sum_{j\in\bm{J}}\sum_{n\in\bm{N_{j}}}c_{i,r} \times x_{i,r,j,n} \\ 
  % 提供側の容量制約
  {\rm s.t.} \quad &\sum_{j\in \bm{J}}\sum_{n\in\bm{N_{j}}}x_{i,r,j,n}
  +\sum_{i\in\bm{I}}\sum_{r\in\bm{R}} q_{i,r}\leq TP_{i,r} \quad (\forall i, \forall r) \\
  &\begin{cases}
    x_{i,r,j,n} = 0 \quad &({\rm if} \ y_{j,n}=0) \\
    \sum_{j \in \bm{J}}\sum_{n \in \bm{N_{j}}} x_{i,r,j,n} = TR_{j,n,r}
    \quad  &({\rm if} \ y_{j,n}=1) 
  \end{cases}
  \\
  % Qを満たすための制約
  &\sum_{i\in\bm{I}} q_{i,r}=Q_{r} \\
  % 要求企業jの入札のうち勝者となる入札は高々１つとする制約
  &\sum_{n \in \bm{N_{j}}}y_{j,n}  \leq 1 \quad (\forall j) \\
  &x_{i,r,j,n}\in {0,1} (\forall i,\forall r\forall j,\forall n )\\
  &y_{j,n} \in \bm{Z} (\forall j,\forall n )
  &q_{i,r} \in \bm{Z} (\forall i,\forall r )
\end{flalign*}
勝者となった入札のみを集めた問題
\begin{flalign*}
  % 目的関数
  {\rm max} \quad &V(\bm{\tilde{I}},\bm{J})\sum_{j\in \bm{J}}\sum_{n\in\bm{N_{j}}}v_{j} \times y_{j,n} - \sum_{i\in\bm{\tilde{I}}}\sum_{r\in\bm{R}}\sum_{j\in\bm{J}}\sum_{n\in\bm{N_{j}}}c_{i,r} \times x_{i,r,j,n} \\ 
  % 提供側の容量制約
  {\rm s.t.} \quad &\sum_{j\in \bm{J}}\sum_{n\in\bm{N_{j}}}x_{i,r,j,n} \leq TP_{i,r} \quad (\forall i, \forall r) \\
  &\begin{cases}
    x_{i,r,j,n} = 0 \quad &({\rm if} \ y_{j,n}=0) \\
    \sum_{j \in \bm{J}}\sum_{n \in \bm{N_{j}}} x_{i,r,j,n} = TR_{j,n,r}
    \quad  &({\rm if} \ y_{j,n}=1) 
  \end{cases}
  \\
  % 要求企業jの入札のうち勝者となる入札は高々１つとする制約
  &\sum_{n \in \bm{N_{j}}}y_{j,n}  \leq 1 \quad (\forall j) \\
  &x_{i,r,j,n}\in {0,1} \\
  &y_{j,n} \in \bm{Z} \\ 
  &y_{j,n}=0 (b_{j,n} \notin \bm{\tilde{B}})
\end{flalign*}

\end{document}
